{% extends 'base.html.twig' %}

{% block title %}Hello WeatherController!{% endblock %}

{% block body %}
<style>
    .main-container { margin: 1em auto; max-width: 800px; width: 95%; font: 18px/1.5 sans-serif; }
    .main-container code { background: #F5F5F5; padding: 2px 6px; }

</style>
    <div class="main-container">

        <form method="post">
            <div class="form-group row">
                <div class="col-xs-4">
                    <input type="api_key" class="form-control" placeholder="API key" id="api_key" name="api_key">
                </div>
                <div class="col-xs-4">
                    <input type="city" class="form-control" placeholder="City" id="city" name="city">
                </div>
                <div class="col-xs-2">
                    <button type="submit" class="btn btn-success">Submit</button>
                </div>
                <a href="{{ path('weather_data') }}"></a>
            </div>
        </form>

        <ul class="nav nav-tabs"></ul>
    </div>
{% endblock %}

{% block page_javascripts %}
    <script>
        $( document ).ready(function() {
            $('form').submit(function(e) {
                e.preventDefault();
                let url = "{{ path('weather_data') }}";
                let formSerialize = $(this).serialize();

                $.post(url, formSerialize, function(response) {
                    let data = response.data;
                    console.log(data);
                    $( ".nav-tabs" ).append(
                        "<li class=\"nav-item\">" +
                            "<a class=\"nav-link active\" href=\"#\">"
                                + data.city +
                            "</a>" +
                        "</li>"
                    )
                    ;
                }, 'JSON');
            });
        });
    </script>
{% endblock %}

